pipeline {

environment {
   existin_repo_name = 'LaunchSatya'

}
    agent any
//s
    stages {
         stage('RepoSync') {
            steps {

             sh "ls -ltr"

                 }
                 }
                  stage('Syncronize SECOND'){
                         steps {
                              script{ 
                                    
                          withCredentials([usernamePassword(credentialsId: 'eeda8f5c-e817-422b-88b9-05748bd892e8', usernameVariable: 'USERNAME', passwordVariable: 'PASSWORD')]) {
                         //sh 'git clone --bare Testing.git source_repository'
                        // dir("source_repository") {
                              
                             try{
                       sh  '  curl -u $USERNAME:169c7e6dc1817850cf83a61d27cba8589c40ee16 "https://api.github.com/user/repos" -d {\\"name\\":\\"LaunchSatya\\", \\"private\\":\\"true\\" } '
                             }catch(all){

                             }
                    //   sh 'curl -u "$USERNAME:$PASSWORD" https://api.github.com/user/repos -d "{\"name\":\"LaunchSatya\"}"' 
		       		     //# Remember replace USER with your username and REPO with your repository/application name!
		       		//     sh 'git remote add origin git@github.com:kdhulipudi/$existin_repo_name.git'
               //  sh 'git push origin master'
                         //try{
                           //  add a remote repository
                             try {
                            sh 'git remote add  second https://$USERNAME:$PASSWORD@github.com/kdhulipudi/LaunchSatya.git'
                             }catch (all){
                                  //asd
 
                             }
                          //   sh 'git remote set-url  second https://$USERNAME:$PASSWORD@github.com/kdhulipudi/LaunchSatya.git'
                            // sh 'git remote set-url  second https://$USERNAME:$PASSWORD@github.com/hdhulipudi/Test.git '
                            // sync back the second repository
                            sh 'git remote set-url  second https://$USERNAME:$PASSWORD@github.com/kdhulipudi/LaunchSatya.git'
                           sh 'git show-ref'
                             //sh( 'git push second --tags ')
                        

                             sh ('git push second HEAD:refs/heads/master')     
//hello
                                  //   }catch(all){
                         //    echo 'aaa'
                         //    }
                             // update the local copy from the first repository
                        //     sh 'git fetch origin --tags'

                             // update the local copy with the second repository
                           //sh 'git fetch second --tags'


                            //sh 'git push second --tags'
                        // }
                          }
                         }
                         }
        }
                 }
                 }
