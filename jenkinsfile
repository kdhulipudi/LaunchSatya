pipeline {

environment {
   existin_repo_name = 'LaunchSatya'

}
    agent any

    stages {
         stage('RepoSync') {
            steps {

             sh "ls -ltr"

                 }
                 }
                  stage('Syncronize SECOND'){
                         steps {
                              script{ 
                                    
                          withCredentials([usernamePassword(credentialsId: 'eeda8f5c-e817-422b-88b9-05748bd892e8', usernameVariable: 'USERNAME', passwordVariable: 'PASSWORD')]) {
                         //sh 'git clone --bare Testing.git source_repository'
                        // dir("source_repository") {
                              
                             try{
                       sh  '  curl -u $USERNAME:4eb836085e541df7a5aa78a7e81f51734fbec54e "https://api.github.com/user/repos" -d {\\"name\\":\\"LaunchSatya\\", \\"private\\":\\"true\\" } '
                             }catch(all){

                             }
                    //   sh 'curl -u "$USERNAME:$PASSWORD" https://api.github.com/user/repos -d "{\"name\":\"LaunchSatya\"}"' 
		       		     //# Remember replace USER with your username and REPO with your repository/application name!
		       		//     sh 'git remote add origin git@github.com:kdhulipudi/$existin_repo_name.git'
               //  sh 'git push origin master'
                       //  try{
                             //add a remote repository
                            // try {
                           // sh 'git remote add  second https://$USERNAME:$PASSWORD@github.com/kdhulipudi/LaunchSatya.git'
                            // }catch (all){
                                  
 
                             //}
                          //   sh 'git remote set-url  second https://$USERNAME:$PASSWORD@github.com/kdhulipudi/LaunchSatya.git'
                            // sh 'git remote set-url  second https://$USERNAME:$PASSWORD@github.com/hdhulipudi/Test.git '
                            // sync back the second repository
                            sh "git remote set-url  second https://$USERNAME:$PASSWORD@github.com/kdhulipudi/LaunchSatya.git"
                           sh 'git show-ref'
                             sh( "git push https://$USERNAME:$PASSWORD@github.com/kdhulipudi/LaunchSatya.git --tags")
                             sh ("git push https://$USERNAME:$PASSWORD@github.com/kdhulipudi/LaunchSatya.git  HEAD:master")

                                  //   }catch(all){
                         //    echo 'aaa'
                         //    }
                             // update the local copy from the first repository
                        //     sh 'git fetch origin --tags'

                             // update the local copy with the second repository
                           //sh 'git fetch second --tags'


                            //sh 'git push second --tags'
                        // }
                          }
                         }
                         }
        }
                 }
                 }
